(function(){"use strict";let i;function g(t){const e=i.__externref_table_alloc();return i.__wbindgen_export_2.set(e,t),e}function O(t,e){try{return t.apply(this,e)}catch(n){const r=g(n);i.__wbindgen_exn_store(r)}}let w=null;function p(){return(w===null||w.byteLength===0)&&(w=new Uint8Array(i.memory.buffer)),w}let m=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&m.decode();const C=2146435072;let x=0;function z(t,e){return x+=e,x>=C&&(m=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}},m.decode(),x=e),m.decode(p().subarray(t,t+e))}function d(t,e){return t=t>>>0,z(t,e)}let a=0;const E=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},F=typeof E.encodeInto=="function"?function(t,e){return E.encodeInto(t,e)}:function(t,e){const n=E.encode(t);return e.set(n),{read:t.length,written:n.length}};function b(t,e,n){if(n===void 0){const _=E.encode(t),f=e(_.length,1)>>>0;return p().subarray(f,f+_.length).set(_),a=_.length,f}let r=t.length,o=e(r,1)>>>0;const c=p();let s=0;for(;s<r;s++){const _=t.charCodeAt(s);if(_>127)break;c[o+s]=_}if(s!==r){s!==0&&(t=t.slice(s)),o=n(o,r,r=s+t.length*3,1)>>>0;const _=p().subarray(o+s,o+r),f=F(t,_);s+=f.written,o=n(o,r,s,1)>>>0}return a=s,o}let u=null;function S(){return(u===null||u.buffer.detached===!0||u.buffer.detached===void 0&&u.buffer!==i.memory.buffer)&&(u=new DataView(i.memory.buffer)),u}function M(t){return t==null}const A=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>{i.__wbindgen_export_6.get(t.dtor)(t.a,t.b)});function W(t,e,n,r){const o={a:t,b:e,cnt:1,dtor:n},c=(...s)=>{o.cnt++;const _=o.a;o.a=0;try{return r(_,o.b,...s)}finally{--o.cnt===0?(i.__wbindgen_export_6.get(o.dtor)(_,o.b),A.unregister(o)):o.a=_}};return c.original=o,A.register(c,o,o),c}function T(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let c="[";o>0&&(c+=T(t[0]));for(let s=1;s<o;s++)c+=", "+T(t[s]);return c+="]",c}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n&&n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function L(t,e){const n=e(t.length*1,1)>>>0;return p().set(t,n/1),a=t.length,n}function I(t,e,n){i.closure22_externref_shim(t,e,n)}function N(t,e,n,r){i.closure42_externref_shim(t,e,n,r)}const R=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>i.__wbg_md5calculator_free(t>>>0,1));class D{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,R.unregister(this),e}free(){const e=this.__destroy_into_raw();i.__wbg_md5calculator_free(e,0)}constructor(){const e=i.md5calculator_new();return this.__wbg_ptr=e>>>0,R.register(this,this.__wbg_ptr,this),this}calculate_md5_async(e,n){const r=L(e,i.__wbindgen_malloc),o=a;return i.md5calculator_calculate_md5_async(this.__wbg_ptr,r,o,n)}set_log_enabled(e){i.md5calculator_set_log_enabled(this.__wbg_ptr,e)}is_log_enabled(){return i.md5calculator_is_log_enabled(this.__wbg_ptr)!==0}start_incremental_md5(e){const n=b(e,i.__wbindgen_malloc,i.__wbindgen_realloc),r=a;i.md5calculator_start_incremental_md5(this.__wbg_ptr,n,r)}update_incremental_md5(e,n){const r=b(e,i.__wbindgen_malloc,i.__wbindgen_realloc),o=a,c=L(n,i.__wbindgen_malloc),s=a;return i.md5calculator_update_incremental_md5(this.__wbg_ptr,r,o,c,s)!==0}finalize_incremental_md5(e,n){let r,o;try{const c=b(e,i.__wbindgen_malloc,i.__wbindgen_realloc),s=a,_=i.md5calculator_finalize_incremental_md5(this.__wbg_ptr,c,s,n);return r=_[0],o=_[1],d(_[0],_[1])}finally{i.__wbindgen_free(r,o,1)}}cancel_incremental_md5(e){const n=b(e,i.__wbindgen_malloc,i.__wbindgen_realloc),r=a;return i.md5calculator_cancel_incremental_md5(this.__wbg_ptr,n,r)!==0}}const U=new Set(["basic","cors","default"]);async function v(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.ok&&U.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function j(){const t={};return t.wbg={},t.wbg.__wbg_call_f2db6205e5c51dc8=function(){return O(function(e,n,r){return e.call(n,r)},arguments)},t.wbg.__wbg_call_fbe8be8bf6436ce5=function(){return O(function(e,n){return e.call(n)},arguments)},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,o;try{r=e,o=n,console.error(d(e,n))}finally{i.__wbindgen_free(r,o,1)}},t.wbg.__wbg_log_9d65cd2d35d46af0=function(e,n){console.log(d(e,n))},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_new_e30c39c06edaabf2=function(e,n){try{var r={a:e,b:n},o=(s,_)=>{const f=r.a;r.a=0;try{return N(f,r.b,s,_)}finally{r.a=f}};return new Promise(o)}finally{r.a=r.b=0}},t.wbg.__wbg_newnoargs_ff528e72d35de39a=function(e,n){return new Function(d(e,n))},t.wbg.__wbg_queueMicrotask_46c1df247678729f=function(e){queueMicrotask(e)},t.wbg.__wbg_queueMicrotask_8acf3ccb75ed8d11=function(e){return e.queueMicrotask},t.wbg.__wbg_resolve_0dac8c580ffd4678=function(e){return Promise.resolve(e)},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){const r=n.stack,o=b(r,i.__wbindgen_malloc,i.__wbindgen_realloc),c=a;S().setInt32(e+4*1,c,!0),S().setInt32(e+4*0,o,!0)},t.wbg.__wbg_static_accessor_GLOBAL_487c52c58d65314d=function(){const e=typeof global>"u"?null:global;return M(e)?0:g(e)},t.wbg.__wbg_static_accessor_GLOBAL_THIS_ee9704f328b6b291=function(){const e=typeof globalThis>"u"?null:globalThis;return M(e)?0:g(e)},t.wbg.__wbg_static_accessor_SELF_78c9e3071b912620=function(){const e=typeof self>"u"?null:self;return M(e)?0:g(e)},t.wbg.__wbg_static_accessor_WINDOW_a093d21393777366=function(){const e=typeof window>"u"?null:window;return M(e)?0:g(e)},t.wbg.__wbg_then_82ab9fb4080f1707=function(e,n,r){return e.then(n,r)},t.wbg.__wbg_then_db882932c0c714c6=function(e,n){return e.then(n)},t.wbg.__wbindgen_cb_drop=function(e){const n=e.original;return n.cnt--==1?(n.a=0,!0):!1},t.wbg.__wbindgen_closure_wrapper100=function(e,n,r){return W(e,n,21,I)},t.wbg.__wbindgen_debug_string=function(e,n){const r=T(n),o=b(r,i.__wbindgen_malloc,i.__wbindgen_realloc),c=a;S().setInt32(e+4*1,c,!0),S().setInt32(e+4*0,o,!0)},t.wbg.__wbindgen_init_externref_table=function(){const e=i.__wbindgen_export_2,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},t.wbg.__wbindgen_is_undefined=function(e){return e===void 0},t.wbg.__wbindgen_string_new=function(e,n){return d(e,n)},t.wbg.__wbindgen_throw=function(e,n){throw new Error(d(e,n))},t}function P(t,e){return i=t.exports,k.__wbindgen_wasm_module=e,u=null,w=null,i.__wbindgen_start(),i}async function k(t){if(i!==void 0)return i;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL(""+new URL("wasm_md5_bg-prdoPY6R.wasm",self.location.href).href,self.location.href));const e=j();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await v(await t,e);return P(n,r)}var l=null,y=null,h=new Map;self.onmessage=async function(t){const{id:e,type:n,data:r}=t.data;if(n==="init_shared_memory"){r!=null&&r.sharedMemory&&(y=new Uint8Array(r.sharedMemory));return}if(n==="calculate")try{l||(await k(),l=new D),r!=null&&r.isStreamMode?await B(e,r):await q(e,r)}catch(o){h.delete(e),self.postMessage({id:e,type:"error",data:{error:o.message}})}if(n==="calculate_chunk")try{await $(e,r)}catch(o){h.delete(e),self.postMessage({id:e,type:"error",data:{error:o.message}})}};async function B(t,e){if(!e)throw new Error("No data provided for stream processing initialization");l||(await k(),l=new D);const n=l;n.start_incremental_md5(t),h.set(t,{hasher:n,processedChunks:0,totalChunks:e.totalChunks||1,totalSize:e.dataLength||0,processedSize:0})}async function $(t,e){if(!e)throw new Error("No data provided for chunk processing");const n=h.get(t);if(!n)throw new Error("Stream state not found");let r;if((e==null?void 0:e.dataOffset)!==void 0&&(e==null?void 0:e.dataLength)!==void 0&&y)r=y.slice(e.dataOffset,e.dataOffset+e.dataLength);else if(e!=null&&e.chunkData)r=new Uint8Array(e.chunkData);else throw new Error("No valid chunk data provided");if(!n.hasher.update_incremental_md5(t,r))throw new Error("Failed to update incremental MD5");n.processedChunks++,n.processedSize+=r.length;const c=n.processedChunks/n.totalChunks*100;if(self.postMessage({id:t,type:"progress",data:{progress:c}}),n.processedChunks>=n.totalChunks){const s=n.hasher.finalize_incremental_md5(t,e.md5Length||32);h.delete(t),self.postMessage({id:t,type:"result",data:{result:s}})}}async function q(t,e){if(!e)throw new Error("No data provided for file processing");l||(await k(),l=new D);let n;if((e==null?void 0:e.dataOffset)!==void 0&&(e==null?void 0:e.dataLength)!==void 0&&y)n=y.slice(e.dataOffset,e.dataOffset+e.dataLength);else if(e!=null&&e.fileData)n=new Uint8Array(e.fileData);else throw new Error("No valid data source provided");const r=await l.calculate_md5_async(n,e.md5Length||32);self.postMessage({id:t,type:"result",data:{result:r}})}})();
